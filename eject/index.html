<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="same-origin">
    <title>hidden_website</title>
    <link rel="shortcut icon" href="https://gitee.com/o0w0b/typora_pic/raw/master/img/22.png" type="image/x-icon">
    <style>
        body {
            background-color: #000;
            margin: 0;
            padding: 0;
            overflow: hidden;
            text-align: center;
        }

        .hidden {
            display: none;
        }

        #display {
            margin: auto;
        }
    </style>
</head>

<body>
    <canvas id="cvs" class="hidden" width="1980" height="1080"></canvas>
    <canvas id="screenImage" class="hidden" width="234" height="357"></canvas>
    <canvas id="rili" class="hidden" width="600" height="600"></canvas>
    <canvas id="display"></canvas>

    <script>
        /* ---------- 画布 ---------- */
        const cvs = document.getElementById('cvs');
        const ctx = cvs.getContext('2d');
        const display = document.getElementById('display');
        const displayCtx = display.getContext('2d');
        const screenImage = document.getElementById('screenImage');
        const screenImageCtx = screenImage.getContext('2d');
        const rili = document.getElementById('rili');
        const riliCtx = rili.getContext('2d');

        /* ---------- 日历 ---------- */
        function drawRili() {
            riliCtx.clearRect(0, 0, 600, 600);
            const d = new Date();
            const y = d.getFullYear();
            const m = d.getMonth();
            const today = d.getDate();
            const week = d.getDay();

            const size = 40;
            const weekEN = ['SUN', 'MON', 'TUES', 'WED', 'THUR', 'FRI', 'SAT'];
            const monthCN = ['一', '二', '三', '四', '五', '六', '七', '八', '九', '十', '十一', '十二'];

            const isLeap = (y % 4 === 0 && y % 100 !== 0) || y % 400 === 0;
            const days = [31, isLeap ? 29 : 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
            const countDay = days[m];

            const wIdx = today % 7;
            let firstDraw = week >= wIdx ? week - wIdx + 1 : week - wIdx + 8;
            let rows = 7 - firstDraw + 7 * 4 < countDay ? 7 : 6;

            function drawTodaybg(j, i) {
                riliCtx.save();
                for (let k = 10; k >= 6; k--) {
                    riliCtx.beginPath();
                    riliCtx.strokeStyle = '#900';
                    riliCtx.arc(45 + j * size * 1.7 + size / 1.18,
                        50 + i * size + size / 2,
                        size / 2 - k,
                        -Math.PI,
                        Math.PI * (0.6 + (k - 6) * 0.1));
                    riliCtx.stroke();
                    riliCtx.closePath();
                }
                riliCtx.restore();
            }

            /* 标题 */
            riliCtx.fillStyle = 'rgb(69,68,84)';
            riliCtx.font = '900 26pt SimHei';
            riliCtx.textAlign = 'center';
            riliCtx.scale(1.1, 1);
            riliCtx.fillText(monthCN[m] + '月', 260, 32);
            riliCtx.resetTransform();
            riliCtx.font = '20pt SimHei';
            riliCtx.textAlign = 'end';
            riliCtx.fillText(today + '日', 520, 38);

            /* 格子 */
            for (let i = 0; i < rows; i++)
                for (let j = 0; j < 7; j++)
                    riliCtx.strokeRect(45 + j * size * 1.7, 50 + i * size, size * 1.7, size);

            /* 星期 */
            for (let j = 0; j < 7; j++) {
                riliCtx.textAlign = 'center';
                riliCtx.fillStyle = 'rgb(69,68,84)';
                riliCtx.font = (size / 1.5) + 'px Impact';
                riliCtx.fillText(weekEN[j], 45 + j * size * 1.7 + size / 1.18, 50 + size / 3 * 2 + 3);
            }

            /* 日期 */
            let idx = 1;
            for (let i = 1; i < rows; i++) {
                for (let j = 0; j < 7; j++) {
                    if (i === 1 && j < firstDraw) continue;
                    if (idx > countDay) break;
                    riliCtx.fillStyle = (j === 0 || j === 6) ? '#900' : 'rgb(69,68,84)';
                    riliCtx.fillText(idx.toString(),
                        45 + j * size * 1.7 + size / 1.18,
                        50 + i * size + size / 3 * 2 + 3);
                    if (idx === today) drawTodaybg(j, i);
                    idx++;
                }
            }
        }
        drawRili();
        setInterval(drawRili, 3600000);

        /* ---------- 图片资源 ---------- */
        const screenMask = new Image();
        screenMask.src = 'https://gitee.com/o0w0b/typora_pic/raw/master/img/Screenmask.png';
        const screen = new Image();
        screen.src = 'https://gitee.com/o0w0b/typora_pic/raw/master/img/screen.png';

        const bg = new Image();
        bg.src = 'https://gitee.com/o0w0b/typora_pic/raw/master/img/bg.png';
        const mask = new Image();
        mask.src = 'https://gitee.com/o0w0b/typora_pic/raw/master/img/mask.png';
        const light = new Image();
        light.src = 'https://gitee.com/o0w0b/typora_pic/raw/master/img/light.png';
        const caidai = new Image();
        caidai.src = 'https://gitee.com/o0w0b/typora_pic/raw/master/img/caidai.png';
        const two = new Image();
        two.src = 'https://gitee.com/o0w0b/typora_pic/raw/master/img/22.png';
        const screenLight = new Image();
        screenLight.src = 'https://gitee.com/o0w0b/typora_pic/raw/master/img/screenLight.png';
        const phoneLight = new Image();
        phoneLight.src = 'https://gitee.com/o0w0b/typora_pic/raw/master/img/phoneLight.png';

        /* ---------- 左上角屏幕绘制 ---------- */
        const iv = setInterval(() => {
            if (screen.complete && screenMask.complete) {
                screenImageCtx.drawImage(screen, -1041, -210, 1280, 720);
                screenImageCtx.globalCompositeOperation = 'destination-atop';
                screenImageCtx.drawImage(screenMask, 0, 0);
                screenImageCtx.globalCompositeOperation = 'source-over';
                clearInterval(iv);
            }
        }, 14);

        /* ---------- 自适应 ---------- */
        window.onresize = () => {
            if (window.innerWidth / window.innerHeight > 1.8333333) {
                display.width = window.innerWidth;
                display.height = window.innerWidth / 1980 * 1080;
                window.scrollTo(0, (window.innerHeight - 123) / 16);
            } else {
                display.width = window.innerHeight / 1080 * 1980;
                display.height = window.innerHeight;
            }
        };
        window.onresize();

        /* ---------- 动画数据 ---------- */
        const data = new Array(128).fill(0);
        const animData = new Array(128).fill(0);
        const min = (a, b) => a < b ? a : b;
        const max = (a, b) => a > b ? a : b;

        /* ---------- 颜色 ---------- */
        let targetColor = { r: 80, g: 120, b: 169 };
        let currentColor = { ...targetColor };
        let lightColor = { r: 0, g: 34, b: 77, a: 0 };
        const colorToRgb = c => `rgb(${c.r},${c.g},${c.b})`;
        const colorToRgba = c => `rgba(${c.r},${c.g},${c.b},${c.a})`;

        /* ---------- 渲染 ---------- */
        function render() {
            /* 数据平滑 */
            for (let i = 0; i < 128; i++) {
                animData[i] += (data[i] - animData[i]) * 0.3;
                animData[i] = min(animData[i], 1);
            }

            /* 昼夜颜色 */
            const h = new Date().getHours();
            const night = !(h >= 6 && h <= 18);
            targetColor = night ? { r: 255, g: 75, b: 80 } : { r: 80, g: 120, b: 169 };
            ['r', 'g', 'b'].forEach(ch => {
                currentColor[ch] += (targetColor[ch] - currentColor[ch]) * 0.01;
                currentColor[ch] = min(max(currentColor[ch], 0), 255);
            });

            /* 清屏 */
            ctx.clearRect(0, 0, 1980, 1080);
            ctx.drawImage(bg, 0, 0);
            ctx.drawImage(mask, 954, 99);

            /* 时间 */
            const t = new Date();
            const pad = n => n < 10 ? '0' + n : n;
            ctx.fillStyle = '#97adbb';
            ctx.font = '32pt Impact';
            ctx.transform(1, 2.05 * Math.PI / 180, 0, 1, 0, 0);
            ctx.fillText(`${pad(t.getHours())}:${pad(t.getMinutes())}:${pad(t.getSeconds())}`, 725, 318);
            ctx.resetTransform();

            /* 日历 */
            ctx.transform(0.9645, 0, 0, 0.96, 967, 100);
            ctx.rotate(6 * Math.PI / 180);
            ctx.drawImage(rili, 0, 0);
            ctx.resetTransform();

            /* 条状动画 */
            ctx.fillStyle = colorToRgb(currentColor);
            for (let i = 32; i < 95; i++)
                ctx.fillRect(10 * (i - 32), 20 + (300 - 300 * animData[i]), 4, 300 * animData[i]);

            /* 光效 */
            night ? lightColor.a = min(lightColor.a + 0.005, 0.7)
                : lightColor.a = max(lightColor.a - 0.005, 0);

            ctx.globalCompositeOperation = 'overlay';
            ctx.drawImage(light, 971, 197);
            ctx.globalCompositeOperation = 'source-over';

            ctx.drawImage(caidai, 949, 25);
            ctx.drawImage(two, 1319, 345);

            if (lightColor.a > 0) {
                ctx.globalCompositeOperation = 'hard-light';
                ctx.fillStyle = colorToRgba(lightColor);
                ctx.fillRect(0, 0, 1980, 1080);
                ctx.globalCompositeOperation = 'source-over';

                ctx.globalAlpha = lightColor.a / 0.7;
                ctx.drawImage(phoneLight, 860, 437);
                ctx.globalAlpha = 1;
            }

            /* 屏幕 */
            ctx.drawImage(screenImage, 0, 0);
            if (lightColor.a > 0) {
                ctx.globalAlpha = lightColor.a / 0.7;
                ctx.drawImage(screenLight, 0, 0);
                ctx.globalAlpha = 1;
            }

            /* 问候语 */
            const phoneText = [
                { time: 0, text: '凌晨啦!' },
                { time: 6, text: '早上好!' },
                { time: 8, text: '上午好!' },
                { time: 11, text: '午休时间!' },
                { time: 13, text: '下午好呀!' },
                { time: 16, text: '傍晚咯!' },
                { time: 19, text: '晚安!' }
            ];
            let greeting = '凌晨啦!';
            phoneText.forEach(v => { if (h >= v.time) greeting = v.text; });

            ctx.fillStyle = '#000';
            ctx.font = '31.02pt SimHei';
            ctx.transform(1.0911, -35 * Math.PI / 180, 0, 0.5868, 1132.94, 564.07);
            ctx.rotate(56.5 * Math.PI / 180);
            ctx.textAlign = 'center';
            ctx.fillStyle = '#fff';
            ctx.fillText(greeting, 135, 100);
            ctx.textAlign = 'start';
            ctx.resetTransform();

            /* 输出到显示画布 */
            displayCtx.drawImage(cvs, 0, 0, display.width, display.height);
            requestAnimationFrame(render);
        }
        requestAnimationFrame(render);
    </script>
</body>

</html>